<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algoritmos Gen√©ticos: Uma Introdu√ß√£o Interativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-gray-50 text-gray-800">

    <header class="bg-white/80 backdrop-blur-sm sticky top-0 z-50 shadow-md">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-teal-600">üß¨ Algoritmos Gen√©ticos</h1>
            <div class="hidden md:flex space-x-2">
                <button onclick="scrollToSection('intro')" class="nav-button px-4 py-2 rounded-md font-semibold text-gray-600 hover:bg-teal-100 transition">Introdu√ß√£o</button>
                <button onclick="scrollToSection('concepts')" class="nav-button px-4 py-2 rounded-md font-semibold text-gray-600 hover:bg-teal-100 transition">Conceitos</button>
                <button onclick="scrollToSection('cycle')" class="nav-button px-4 py-2 rounded-md font-semibold text-gray-600 hover:bg-teal-100 transition">O Ciclo</button>
                <button onclick="scrollToSection('demo')" class="nav-button px-4 py-2 rounded-md font-semibold text-gray-600 hover:bg-teal-100 transition">Simula√ß√£o</button>
                <button onclick="scrollToSection('apps')" class="nav-button px-4 py-2 rounded-md font-semibold text-gray-600 hover:bg-teal-100 transition">Aplica√ß√µes</button>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-8">
        
        <section id="intro" class="text-center py-16">
            <h2 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-4">Introdu√ß√£o aos Algoritmos Gen√©ticos</h2>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
                Imagine que voc√™ precisa encontrar a melhor solu√ß√£o para um problema muito complexo, como otimizar uma rota de entrega ou criar o design de uma pe√ßa de motor. Os Algoritmos Gen√©ticos (AGs) fazem isso se inspirando na teoria da evolu√ß√£o de Darwin. Eles criam uma "popula√ß√£o" de solu√ß√µes candidatas e, atrav√©s de um processo de "sele√ß√£o natural", "cruzamento" e "muta√ß√£o" ao longo de v√°rias "gera√ß√µes", evoluem para encontrar solu√ß√µes cada vez melhores.
            </p>
        </section>

        <section id="concepts" class="py-16 bg-white rounded-2xl shadow-lg">
            <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">Os Pilares da Evolu√ß√£o Digital</h3>
                <p class="text-gray-600 mt-2">Todo Algoritmo Gen√©tico √© constru√≠do sobre estes conceitos fundamentais.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-8">
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">üß¨ Indiv√≠duo (ou Cromossomo)</h4>
                    <p class="text-gray-600">Representa uma √∫nica solu√ß√£o candidata para o problema. √â como o DNA de um ser vivo, contendo toda a informa√ß√£o que o define.</p>
                </div>
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Popula√ß√£o</h4>
                    <p class="text-gray-600">Um conjunto de indiv√≠duos. Uma popula√ß√£o diversificada aumenta a chance de encontrar boas solu√ß√µes, assim como a diversidade gen√©tica √© crucial para a sobreviv√™ncia de uma esp√©cie.</p>
                </div>
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">üèÜ Fun√ß√£o de Aptid√£o (Fitness)</h4>
                    <p class="text-gray-600">Uma fun√ß√£o que mede a qualidade de um indiv√≠duo. Ela determina o qu√£o "boa" √© uma solu√ß√£o, guiando o processo de sele√ß√£o. √â o crit√©rio de "sobreviv√™ncia do mais apto".</p>
                </div>
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">‚úÖ Sele√ß√£o</h4>
                    <p class="text-gray-600">O processo de escolher os indiv√≠duos mais aptos da popula√ß√£o para se tornarem "pais" da pr√≥xima gera√ß√£o. Indiv√≠duos com maior fitness t√™m maior probabilidade de serem selecionados.</p>
                </div>
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">üîÑ Cruzamento (Crossover)</h4>
                    <p class="text-gray-600">Combina o "material gen√©tico" de dois pais para criar um ou mais "filhos". Os filhos herdam caracter√≠sticas de ambos os pais, permitindo a explora√ß√£o de novas combina√ß√µes de solu√ß√µes.</p>
                </div>
                <div class="concept-card bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h4 class="text-xl font-bold text-teal-700 mb-2">‚ùóÔ∏è Muta√ß√£o</h4>
                    <p class="text-gray-600">Uma pequena altera√ß√£o aleat√≥ria no "DNA" de um filho. A muta√ß√£o √© essencial para introduzir novidade na popula√ß√£o e evitar que o algoritmo fique preso em solu√ß√µes sub√≥timas.</p>
                </div>
            </div>
        </section>

        <section id="cycle" class="py-16">
            <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">O Ciclo da Vida de um AG</h3>
                <p class="text-gray-600 mt-2">Veja como esses conceitos trabalham juntos, passo a passo, para criar uma nova gera√ß√£o.</p>
            </div>
            <div class="bg-white p-8 rounded-2xl shadow-lg flex flex-col lg:flex-row items-center gap-8">
                <div id="cycle-animation" class="w-full lg:w-2/3 h-96 bg-gray-100 rounded-lg p-4 flex items-center justify-center text-center font-mono text-sm relative overflow-hidden">
                    <div id="cycle-content" class="fade-in">
                        <p class="text-lg">Clique em "Iniciar" para ver a m√°gica acontecer!</p>
                    </div>
                </div>
                <div class="w-full lg:w-1/3">
                    <div id="cycle-controls">
                        <h4 id="cycle-step-title" class="text-2xl font-bold mb-4 text-gray-700">Passo 0: In√≠cio</h4>
                        <p id="cycle-step-description" class="text-gray-600 mb-6 min-h-[100px]">
                            O ciclo evolutivo come√ßa com uma popula√ß√£o de solu√ß√µes geradas aleatoriamente. A partir daqui, vamos refinar essa popula√ß√£o para encontrar a melhor solu√ß√£o.
                        </p>
                        <div class="flex space-x-4">
                            <button id="cycle-start-btn" onclick="startCycle()" class="w-full bg-teal-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-600 transition">
                                Iniciar Ciclo
                            </button>
                            <button id="cycle-next-btn" onclick="nextCycleStep()" class="w-full bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition hidden">
                                Pr√≥ximo Passo
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="demo" class="py-16">
            <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">Simula√ß√£o Interativa</h3>
                <p class="text-gray-600 mt-2">Defina uma frase alvo e veja o algoritmo evoluir para encontr√°-la.</p>
            </div>
            <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div>
                        <label for="targetString" class="block text-sm font-medium text-gray-700">Frase Alvo</label>
                        <input type="text" id="targetString" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500" value="Ser ou nao ser">
                    </div>
                    <div>
                        <label for="populationSize" class="block text-sm font-medium text-gray-700">Tamanho da Popula√ß√£o</label>
                        <input type="number" id="populationSize" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500" value="200">
                    </div>
                    <div>
                        <label for="mutationRate" class="block text-sm font-medium text-gray-700">Taxa de Muta√ß√£o (%)</label>
                        <input type="number" id="mutationRate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500" value="1">
                    </div>
                </div>
                <div class="text-center mb-8">
                    <button id="start-ga-btn" onclick="startGA()" class="bg-teal-500 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-teal-600 transition">Iniciar Evolu√ß√£o</button>
                    <button id="stop-ga-btn" onclick="stopGA()" class="bg-red-500 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-red-600 transition hidden">Parar</button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 text-center font-mono p-4 bg-gray-100 rounded-lg mb-8">
                    <div>
                        <h4 class="font-sans font-semibold text-gray-600">Melhor Indiv√≠duo</h4>
                        <p id="best-individual" class="text-teal-600 text-lg font-bold break-all">-</p>
                    </div>
                    <div>
                        <h4 class="font-sans font-semibold text-gray-600">Gera√ß√£o</h4>
                        <p id="generation-count" class="text-gray-800 text-lg font-bold">0</p>
                    </div>
                    <div>
                        <h4 class="font-sans font-semibold text-gray-600">Aptid√£o M√©dia</h4>
                        <p id="average-fitness" class="text-gray-800 text-lg font-bold">0.00%</p>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="fitness-chart"></canvas>
                </div>
            </div>
        </section>

        <section id="apps" class="py-16">
            <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">Onde a Evolu√ß√£o Acontece?</h3>
                <p class="text-gray-600 mt-2">Algoritmos Gen√©ticos n√£o s√£o apenas teoria. Eles resolvem problemas reais em diversas √°reas.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <div class="text-4xl mb-4">üìà</div>
                    <h4 class="text-lg font-bold mb-2">Otimiza√ß√£o</h4>
                    <p class="text-sm text-gray-600">Encontrar os melhores par√¢metros para sistemas complexos, como rotas log√≠sticas (o problema do caixeiro viajante) ou design de engenharia.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <div class="text-4xl mb-4">ü§ñ</div>
                    <h4 class="text-lg font-bold mb-2">Machine Learning</h4>
                    <p class="text-sm text-gray-600">Ajustar os par√¢metros de redes neurais (neuroevolu√ß√£o) e selecionar as melhores features para modelos preditivos.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <div class="text-4xl mb-4">üí∞</div>
                    <h4 class="text-lg font-bold mb-2">Finan√ßas</h4>
                    <p class="text-sm text-gray-600">Desenvolver estrat√©gias de negocia√ß√£o (trading) e otimizar portf√≥lios de investimentos para maximizar retornos e minimizar riscos.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center">
                    <div class="text-4xl mb-4">üé®</div>
                    <h4 class="text-lg font-bold mb-2">Design e Arte</h4>
                    <p class="text-sm text-gray-600">Gerar arte, m√∫sica e designs inovadores atrav√©s da evolu√ß√£o de solu√ß√µes criativas, explorando combina√ß√µes inesperadas.</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-white py-6 text-center">
        <p>Uma introdu√ß√£o interativa aos Algoritmos Gen√©ticos.</p>
    </footer>

    <script>
        let currentStep = 0;
        const cycleSteps = [
            {
                title: "Passo 1: Popula√ß√£o Inicial",
                description: "Tudo come√ßa com um grupo de indiv√≠duos aleat√≥rios. Cada um √© uma tentativa de solu√ß√£o. A maioria √© ruim, mas eles s√£o a mat√©ria-prima para a evolu√ß√£o.",
                action: showInitialPopulation
            },
            {
                title: "Passo 2: Avalia√ß√£o (Fitness)",
                description: "Calculamos a 'aptid√£o' de cada indiv√≠duo. Aqui, a aptid√£o √© o qu√£o perto a string est√° de 'EVOLUIR'. Quanto mais letras corretas na posi√ß√£o certa, maior a aptid√£o.",
                action: showFitness
            },
            {
                title: "Passo 3: Sele√ß√£o",
                description: "Selecionamos os 'pais' para a pr√≥xima gera√ß√£o. Indiv√≠duos com maior aptid√£o (destacados em verde) t√™m mais chances de serem escolhidos para reproduzir.",
                action: showSelection
            },
            {
                title: "Passo 4: Cruzamento (Crossover)",
                description: "Dois pais s√£o escolhidos e seus 'DNAs' s√£o combinados. Um ponto de corte √© definido, e o filho herda uma parte de cada pai, criando uma nova combina√ß√£o.",
                action: showCrossover
            },
            {
                title: "Passo 5: Muta√ß√£o",
                description: "Com uma pequena probabilidade, um 'gene' (caractere) do novo filho sofre uma muta√ß√£o aleat√≥ria. Isso introduz novidade e previne a estagna√ß√£o.",
                action: showMutation
            },
            {
                title: "Passo 6: Nova Gera√ß√£o",
                description: "O processo √© repetido at√© que uma nova popula√ß√£o de filhos seja criada, substituindo a antiga. Esta nova gera√ß√£o √©, em m√©dia, mais apta que a anterior. O ciclo ent√£o recome√ßa.",
                action: showNewGeneration
            }
        ];

        const cycleDOM = {
            content: document.getElementById('cycle-content'),
            title: document.getElementById('cycle-step-title'),
            description: document.getElementById('cycle-step-description'),
            startBtn: document.getElementById('cycle-start-btn'),
            nextBtn: document.getElementById('cycle-next-btn')
        };

        const target = "EVOLUIR";
        let population = ["AXSFIUD", "KVMDOQP", "ECOLUCR", "NBJAHYR", "QWEASDZ"];
        
        function updateCycleUI() {
            const step = cycleSteps[currentStep];
            cycleDOM.title.textContent = step.title;
            cycleDOM.description.textContent = step.description;
            step.action();
        }

        function startCycle() {
            currentStep = 0;
            cycleDOM.startBtn.classList.add('hidden');
            cycleDOM.nextBtn.classList.remove('hidden');
            cycleDOM.nextBtn.textContent = "Pr√≥ximo Passo";
            updateCycleUI();
        }

        function nextCycleStep() {
            currentStep++;
            if (currentStep < cycleSteps.length) {
                updateCycleUI();
                if (currentStep === cycleSteps.length - 1) {
                    cycleDOM.nextBtn.textContent = "Reiniciar";
                }
            } else {
                currentStep = -1; 
                cycleDOM.content.innerHTML = `<p class="text-lg">Clique em "Iniciar" para ver a m√°gica acontecer!</p>`;
                cycleDOM.title.textContent = "Passo 0: In√≠cio";
                cycleDOM.description.textContent = "O ciclo evolutivo come√ßa com uma popula√ß√£o de solu√ß√µes geradas aleatoriamente. A partir daqui, vamos refinar essa popula√ß√£o para encontrar a melhor solu√ß√£o.";
                cycleDOM.startBtn.classList.remove('hidden');
                cycleDOM.nextBtn.classList.add('hidden');
            }
        }
        
        function getFitness(str) {
            let score = 0;
            for(let i = 0; i < str.length; i++) {
                if(str[i] === target[i]) score++;
            }
            return score;
        }

        function showInitialPopulation() {
            let html = `<div class="grid grid-cols-1 gap-2 text-center">`;
            population.forEach(ind => {
                html += `<div>${ind}</div>`;
            });
            html += `</div>`;
            cycleDOM.content.innerHTML = html;
            cycleDOM.content.classList.add('fade-in');
            setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }

        function showFitness() {
            let html = `<div class="grid grid-cols-1 gap-2 text-center">`;
            population.forEach(ind => {
                html += `<div>${ind} <span class="font-bold text-blue-600">[Aptid√£o: ${getFitness(ind)}]</span></div>`;
            });
            html += `</div>`;
            cycleDOM.content.innerHTML = html;
            cycleDOM.content.classList.add('fade-in');
            setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }

        function showSelection() {
            let html = `<div class="grid grid-cols-1 gap-2 text-center">`;
            population.forEach(ind => {
                const fitness = getFitness(ind);
                const isFit = fitness >= 5;
                html += `<div class="${isFit ? 'bg-green-200 rounded p-1' : ''}">${ind} <span class="font-bold text-blue-600">[Aptid√£o: ${fitness}]</span></div>`;
            });
            html += `</div>`;
            cycleDOM.content.innerHTML = html;
            cycleDOM.content.classList.add('fade-in');
            setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }
        
        function showCrossover() {
            const parentA = "ECOLUCR"; 
            const parentB = "EVOLUIR";
            const cutPoint = 3;
            const child = parentA.substring(0, cutPoint) + parentB.substring(cutPoint);
            
            let html = `<div class="flex flex-col items-center justify-center space-y-4">`;
            html += `<div>Pai A: <span class="text-red-500">${parentA.substring(0, cutPoint)}</span><span class="text-blue-500">${parentA.substring(cutPoint)}</span></div>`;
            html += `<div>Pai B: <span class="text-red-500">${parentB.substring(0, cutPoint)}</span><span class="text-blue-500">${parentB.substring(cutPoint)}</span></div>`;
            html += `<div class="text-2xl font-bold">&darr;</div>`;
            html += `<div>Filho: <span class="text-red-500">${child.substring(0, cutPoint)}</span><span class="text-blue-500">${child.substring(cutPoint)}</span></div>`;
            html += `</div>`;
            cycleDOM.content.innerHTML = html;
            cycleDOM.content.classList.add('fade-in');
            setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }
        
        function showMutation() {
             const child = "EVOLUCR";
             const mutatedChild = "EVOLU<span class='text-purple-600 bg-purple-200 px-1 rounded'>I</span>R";
             let html = `<div class="flex flex-col items-center justify-center space-y-4">`;
             html += `<div>Filho antes da muta√ß√£o: ${child}</div>`;
             html += `<div class="text-2xl font-bold">&darr;</div>`;
             html += `<div>Filho ap√≥s muta√ß√£o: ${mutatedChild}</div>`;
             html += `</div>`;
             cycleDOM.content.innerHTML = html;
             cycleDOM.content.classList.add('fade-in');
             setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }

        function showNewGeneration() {
            let html = `<div class="text-center">`;
            html += `<div class="mb-4 text-gray-500 line-through">Popula√ß√£o Antiga</div>`;
            html += `<div class="text-xl font-bold text-teal-600">Nova Gera√ß√£o, Mais Apta!</div>`;
            html += `</div>`;
            cycleDOM.content.innerHTML = html;
            cycleDOM.content.classList.add('fade-in');
            setTimeout(() => cycleDOM.content.classList.remove('fade-in'), 500);
        }

        let gaRunner;
        let fitnessChart;
        let isGARunning = false;
        
        function startGA() {
            const targetString = document.getElementById('targetString').value;
            const populationSize = parseInt(document.getElementById('populationSize').value);
            const mutationRate = parseFloat(document.getElementById('mutationRate').value) / 100;
            
            if (!targetString || isNaN(populationSize) || isNaN(mutationRate)) {
                alert("Por favor, preencha todos os campos corretamente.");
                return;
            }

            document.getElementById('start-ga-btn').classList.add('hidden');
            document.getElementById('stop-ga-btn').classList.remove('hidden');
            isGARunning = true;

            let population = [];
            let generations = 0;
            let bestFitnessHistory = [];
            let avgFitnessHistory = [];
            const validChars = ' abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,!?';

            function getRandomChar() {
                return validChars.charAt(Math.floor(Math.random() * validChars.length));
            }

            for (let i = 0; i < populationSize; i++) {
                let individual = '';
                for (let j = 0; j < targetString.length; j++) {
                    individual += getRandomChar();
                }
                population.push({dna: individual, fitness: 0});
            }

            function calculateFitness() {
                let totalFitness = 0;
                for (let ind of population) {
                    let score = 0;
                    for (let i = 0; i < ind.dna.length; i++) {
                        if (ind.dna[i] === targetString[i]) {
                            score++;
                        }
                    }
                    ind.fitness = score / targetString.length;
                    totalFitness += ind.fitness;
                }
                return totalFitness / populationSize;
            }

            function selection() {
                const matingPool = [];
                for (const ind of population) {
                    const n = Math.floor(ind.fitness * 100) + 1;
                    for (let i = 0; i < n; i++) {
                        matingPool.push(ind);
                    }
                }
                return matingPool;
            }

            function crossover(parentA, parentB) {
                const midpoint = Math.floor(Math.random() * targetString.length);
                const childDna = parentA.dna.substring(0, midpoint) + parentB.dna.substring(midpoint);
                return {dna: childDna, fitness: 0};
            }

            function mutate(individual) {
                let newDna = '';
                for (let i = 0; i < individual.dna.length; i++) {
                    if (Math.random() < mutationRate) {
                        newDna += getRandomChar();
                    } else {
                        newDna += individual.dna[i];
                    }
                }
                individual.dna = newDna;
            }
            
            if (fitnessChart) {
                fitnessChart.destroy();
            }
            const ctx = document.getElementById('fitness-chart').getContext('2d');
            fitnessChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                    {
                        label: 'Melhor Aptid√£o',
                        data: [],
                        borderColor: '#14b8a6',
                        tension: 0.1,
                        fill: false
                    },
                    {
                        label: 'Aptid√£o M√©dia',
                        data: [],
                        borderColor: '#6b7280',
                        tension: 0.1,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1,
                            ticks: {
                                callback: function(value) {return (value * 100).toFixed(0) + '%'}
                            }
                        }
                    }
                }
            });

            function evolve() {
                if (!isGARunning) return;

                const averageFitness = calculateFitness();
                
                population.sort((a, b) => b.fitness - a.fitness);
                const bestIndividual = population[0];

                bestFitnessHistory.push(bestIndividual.fitness);
                avgFitnessHistory.push(averageFitness);
                
                document.getElementById('best-individual').textContent = bestIndividual.dna;
                document.getElementById('generation-count').textContent = generations;
                document.getElementById('average-fitness').textContent = (averageFitness * 100).toFixed(2) + '%';
                
                fitnessChart.data.labels.push(generations);
                fitnessChart.data.datasets[0].data = bestFitnessHistory;
                fitnessChart.data.datasets[1].data = avgFitnessHistory;
                fitnessChart.update();

                if (bestIndividual.dna === targetString) {
                    stopGA();
                    document.getElementById('best-individual').classList.add('bg-green-200', 'p-2', 'rounded-md');
                    return;
                }

                const matingPool = selection();
                const newPopulation = [];

                for (let i = 0; i < populationSize; i++) {
                    const parentA = matingPool[Math.floor(Math.random() * matingPool.length)];
                    const parentB = matingPool[Math.floor(Math.random() * matingPool.length)];
                    const child = crossover(parentA, parentB);
                    mutate(child);
                    newPopulation.push(child);
                }
                population = newPopulation;
                generations++;
                
                gaRunner = requestAnimationFrame(evolve);
            }
            evolve();
        }

        function stopGA() {
            isGARunning = false;
            cancelAnimationFrame(gaRunner);
            document.getElementById('start-ga-btn').classList.remove('hidden');
            document.getElementById('stop-ga-btn').classList.add('hidden');
        }
        
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }
        
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section');
            const navButtons = document.querySelectorAll('.nav-button');
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if(pageYOffset >= sectionTop - 60){
                    currentSection = section.getAttribute('id');
                }
            });

            navButtons.forEach(button => {
                button.classList.remove('active');
                if (button.getAttribute('onclick').includes(currentSection)) {
                    button.classList.add('active');
                }
            });
        });

    </script>
</body>
</html>
